# CodeCouncil AI â€“ Enterprise SaaS Platform ğŸš€

Your on-demand AI engineering workforce. Architecture reviews, security audits, and product analysisâ€”delivered instantly.

**Status**: âœ… Production-Ready with 6 Enterprise Features
- âœ… Stripe Subscriptions (monthly/annual plans)
- âœ… Admin Dashboard (user management + analytics)
- âœ… Per-user Rate Limiting (database-backed)
- âœ… Audit Logging Dashboard (security events)
- âœ… Automated Database Backups (PostgreSQL)
- âœ… Monitoring Stack (Prometheus + Grafana)

## Project Structure

```
CodeConcilAI/
â”œâ”€â”€ codecouncil-ai/          # Frontend (React + Vite)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ apiService.ts    # â† Backend communication
â”‚   â”‚   â”œâ”€â”€ geminiService.ts # Gemini AI integration
â”‚   â”‚   â””â”€â”€ githubService.ts # GitHub repo fetching
â”‚   â””â”€â”€ ...
â”œâ”€â”€ backend/                 # Node.js + Express API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts      # OAuth 2.0 authentication
â”‚   â”‚   â”‚   â”œâ”€â”€ billing.ts   # Credits & tier management
â”‚   â”‚   â”‚   â””â”€â”€ gemini.ts    # Gemini API proxy
â”‚   â”‚   â””â”€â”€ middleware/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ ...
â”œâ”€â”€ DEPLOY.md               # Deployment guides
â””â”€â”€ docker-compose.yml      # Local dev stack
```

## Core Features

âœ… **OAuth 2.0 Authentication** â€“ Google login with JWT tokens  
âœ… **Stripe Subscriptions** â€“ Monthly/annual billing with automatic renewal  
âœ… **Credit-Based System** â€“ Tiered plans (Startup/Enterprise) with 400 trial credits  
âœ… **BYOK Support** â€“ Users bring their own Gemini key for unlimited access  
âœ… **AI Agents** â€“ 6 specialized agents for analysis (Architecture, QA, Product, Legal, Writer, AI)  
âœ… **Multi-Language** â€“ Portuguese, English, French  
âœ… **GitHub Integration** â€“ Analyze repositories directly  
âœ… **Export Reports** â€“ Markdown with PDF rendering  
âœ… **Admin Dashboard** â€“ User management, analytics, billing control  
âœ… **Audit Logging** â€“ Compliance-ready security event tracking  
âœ… *Documentation

ğŸ“– **Read First**: [QUICKSTART.md](./QUICKSTART.md) â€“ Quick reference guide  
ğŸ“š **Full Setup**: [ENTERPRISE.md](./ENTERPRISE.md) â€“ Complete enterprise features guide  
ğŸš€ **Deploy**: [PRODUCTION.md](./PRODUCTION.md) â€“ Deployment to production platforms  
ğŸ“‹ **Implementation**: [IMPLEMENTATION_SUMMARY.md](./IMPLEMENTATION_SUMMARY.md) â€“ Technical details

## Quick Start

### 1. One-Command Setup (Docker)rometheus + Grafana with alerts  
âœ… **TypeScript** â€“ Type-safe throughout (frontend + backend)  
âœ… **Docker** â€“ Containerized for any platform  

## Quick Start

### 1. Clone & Setup

```bash
git clone <repo>
cd CodeConcilAI

# Run setup script (handles dependencies, database, Docker)
chmod +x setup.sh
./setup.sh
```

This3script:
- âœ… Installs dependencies
- âœ… Sets up PostgreSQL database
- âœ… Creates .env files
- âœ… Starts Docker Compose with all services

### 2. Manual Setup (Optional)

### 2. Get Credentials

You'll need:
- **Google OAuth 2.0:** [Google Cloud Console](https://console.cloud.google.com/)
  - Create Web app credentials
  - Add `http://localhost:3000` to authorized origins
  - Add `http://localhost:5000/api/auth/google/callback` to redirect URIs

- **Gemini API Key:** [Google AI Studio](https://aistudio.google.com/)
  - Get your API key from settings

### 4. Fill Environment Files

**backend/.env.local:**
```env
GOOGLE_CLIENT_ID=your-client-id
GOOGLE_CLIENT_SECRET=your-client-secret
GEMINI_API_KEY=your-gemini-key
JWT_SECRET=$(openssl rand -base64 32)
```

**codecouncil-ai/.env.local:**
```env
VITE_API_URL=http://localhost:5000
VITE_GOOGLE_CLIENT_ID=your-client-id
```

### 5. Start Stack

**Option A: Docker Compose (Recommended)**

```bash
docker-compose up
```

Then open:
- Frontend: http://localhost:3000
- Backend: http://localhost:5000
- Health: http://localhost:5000/health

**Option B: Manual Dev Servers**

Terminal 1 (Frontend):
```bash
cd codecouncil-ai
npm install
npm run dev
```

Terminal 2 (Backend):
```bash
cd backend
npm install
npm run build
npm run dev
```

## Deployment

See **[PRODUCTION.md](./PRODUCTION.md)** for:
- Railway / Render / Vercel setup
- AWS / DigitalOcean / Heroku guides
- Production checklist
- CI/CD pipelines

**Quick Deploy (Railway):**
1. Push to GitHub
2. Connect at railway.app
3. Set environment variables
4. Deploy (auto on push)

## API Reference

### Authentication
- `POST /api/auth/google` â€“ Sign in with Google ID token
- `GET /api/auth/me` â€“ Get current user
- `POST /api/auth/refresh` â€“ Refresh JWT

### Subscriptions
- `GET /api/subscriptions/plans` â€“ List all plans
- `GET /api/subscriptions/current` â€“ Get user subscription
- `POST /api/subscriptions/create` â€“ Create subscription
- `POST /api/subscriptions/cancel` â€“ Cancel subscription
- `POST /api/subscriptions/change-plan` â€“ Upgrade/downgrade

### Billing & Credits
- `GET /api/billing/usage` â€“ Check credits
- `POST /api/billing/process-transaction` â€“ Deduct credits
- `POST /api/billing/upgrade-to-unlimited` â€“ Enable unlimited

### Admin Dashboard
- `GET /api/admin/stats` â€“ Dashboard metrics
- `GET /api/admin/audit-logs` â€“ Audit events (filterable)
- `GET /api/admin/users/:id` â€“ User details
- `POST /api/admin/users/:id/suspend` â€“ Suspend user
- `GET /api/admin/analytics` â€“ Usage analytics

### Rate Limiting
- `GET /api/rate-limit/usage` â€“ User's rate limits


| Plan | Agents | Languages | Monthly Cost | Annual Cost | Monthly Credits |
|------|--------|-----------|--------------|-------------|-----------------|
| **Startup** | 3 (Architect, QA, Product) | 1 (English) | $49 | $499 (20% off) | 300 credits |
| **Enterprise** | 6 (All agents) | 3 (EN/PT/FR) | $149 | $1,499 (20% off) | 1,000 credits |
| **Trial** | All features | 3 languages | Free | â€“ | 400 credits (one-time) |

**Credit Usage:** 50 credits per Startup audit, 150 credits per Enterprise audit

New users get **400 trial credits** (~8 analyse
**Example Request:**
```bash
curl -X POST http://localhost:5000/api/subscriptions/create \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ "planId": "startup_monthly" }'
```

## Pricing (Configurable)

| Plan | Agents | Languages | Trial Credits | Cost |
|------|--------|-----------|----------------|------|
| **Startup Audit** | 3 (Architect, QA, Product) | 1 (English) | 50 per audit | Pay-as-you-go or subscription |
| **Enterprise Deep Dive** | 6 (All agents) | 3 (EN/PT/FR) | 150 per audit | Premium pricing |

New users get **400 trial credits** (5 Startup or 2 Enterprise audits).

## Architectureâ”
â”‚ Frontend (React 19 + Vite 6)        â”‚
â”‚ â”œâ”€ Google OAuth Login               â”‚
â”‚ â”œâ”€ Subscription Management UI       â”‚
â”‚ â”œâ”€ File/GitHub Repo Input           â”‚
â”‚ â”œâ”€ Agent Dashboard & Reports        â”‚
â”‚ â””â”€ Admin Panel (admins only)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPS / JWT
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend (Node.js + Express)         â”‚
â”‚ â”œâ”€ OAuth 2.0 + JWT (7-day)          â”‚
â”‚ â”œâ”€ Stripe Subscriptions             â”‚
â”‚ â”œâ”€ Credit Billing & Rate Limiting   â”‚
â”‚ â”œâ”€ Gemini API Proxy (backend-only)  â”‚
â”‚ â”œâ”€ Admin Dashboard API              â”‚
â”‚ â”œâ”€ Audit Logging                    â”‚
â”‚ â””â”€ Prometheus Metrics               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚     Features

âœ… **Authentication**
- OAuth 2.0 (passwordless Google login)
- JWT tokens (7-day expiration)
- Refresh token rotation

âœ… **API Protection**
- Per-user rate limiting (database-backed)
- Request validation & sanitization
- CORS restricted to allowed domains
- CSP headers in frontend

âœ… **Data Security**
- API keys stored in backend (never in client)
- Stripe webhook signature verification
- Encrypted database connections
- Automated daily backups (30-day retention)

âœ… **Compliance**
- Audit logging (all user actions)
- Severity-based alerting
- GDPR-ready (user data export)
- PII protection in logs

âœ… **Monitoring**
- Real-time error tracking (Sentry)
- Security event alerts
- Performance monitoring
- Automated incident response dashboards  
**Backups**: Daily automated PostgreSQL backups              â”œâ”€â–º Google Gemini API
                 â”œâ”€â–º GitHub API
                 â””â”€â–º (Future) PostgreSQL + Stripe
```

## Security Considerations

- âœ… JWT tokens with 7-day expiration
- âœ… OAuth 2.0 for passwordless auth
- âœ… API key stored in backend (never exposed to browser)
- âœ… CORS restricted to frontend domain
- âœ… CSP headers in frontend
- âœ… Request validation & error handling
- âš ï¸ Rate limiting (add in production)
- âš ï¸ Database encryption (add in production)

## Production Checklist

âœ… **Already Implemented**
- [x] Stripe subscription billing
- [x] PostgreSQL database
- [x] Per-user rate limiting
- [x] Admin dashboard
- [x] Audit logging
- [x] Email notifications (SendGrid)
- [x] Error tracking (Sentry)
- [x] Monitoring (Prometheus + Grafana)
- [x] Automated backups
- [x] CORS & CSP headers
- [x] Request validation

**Before Launch**
- [ ] All env vars in secrets manager
- [ ] HTTPS/SSL enabled
- [ ] DNS configured
- [ ] Admin user created
- [ ] Stripe products created with price IDs
- [ ] Backup cron job scheduled
- [ ] Slack/PagerDuty alerts configured
- [ ] Privacy policy & Terms published
- [ ] Support email configured
- [ ] Monitoring dashboards verified

## Troubleshooting

**"Invalid Google token"**
- Verify GOOGLE_CLIENT_ID matches in frontend & backend
- Check OAuth credentials are for Web app, not mobile

**"CORS blocked"**
- Ensure FRONTEND_URL in backend .env matches your frontend domain
- Check CORS middleware in backend/src/index.ts

**"Gemini API error"**
- Confirm GEMINI_API_KEY is valid
- Check API quota hasn't been exceeded

**"Rate limit exceeded"**
- Check user's tier with `GET /api/rate-limit/usage`
- Admin can reset: `UPDATE "RateLimitTracker" SET "requestsToday" = 0`

**"Stripe webhook not processing"**
- Verify webhook endpoint registered in Stripe Dashboard
- Check webhook signature in logs
- Test with: `curl -X POST http://localhost:5000/api/billing/stripe/webhook`

**"Backup/restore failed"**
- Run: `gunzip -t /var/backups/codecouncil-ai/*.sql.gz`
- Check database permissions
- Verify PostgreSQL is running

**Need help?** Check the full troubleshooting section in [ENTERPRISE.md](./ENTERPRISE.md)

## Contributing

Issues & PRs welcome! Follow these steps:
1. Create feature branch: `git checkout -b feature/my-feature`
2. Commit: `git commit -m "Add feature"`
3. Push: `git push origin feature/my-feature`
4. Open Pull Request

## Getting Started

1. **Quick Reference**: [QUICKSTART.md](./QUICKSTART.md)
2. **Full Setup**: [ENTERPRISE.md](./ENTERPRISE.md) 
3. **Deployment**: [PRODUCTION.md](./PRODUCTION.md)
4. **Implementation Details**: [IMPLEMENTATION_SUMMARY.md](./IMPLEMENTATION_SUMMARY.md)

## Verify Installation

```bash
chmod +x verify.sh
./verify.sh
```

This will confirm all 6 enterprise features are properly implemented.

---

**Ready to launch?** Follow [QUICKSTART.md](./QUICKSTART.md) then [ENTERPRISE.md](./ENTERPRISE.md)

**Questions?** Open an issue or check the troubleshooting section above.

**Status**: âœ… Production-Ready for SaaS Launch

- ğŸ“§ Email: support@codecouncil.ai
- ğŸ’¬ Discord: [Join community](https://discord.gg/codecouncil)
- ğŸ“š Docs: Full API docs at /docs (coming soon)

---

**Ready to launch?** Head to [DEPLOY.md](./DEPLOY.md) for production deployment guides.

**Have questions?** Check the [FAQ](./FAQ.md) or open an issue.

Good luck! ğŸš€